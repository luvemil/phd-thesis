%************************************************
\chapter{Nakaoka contexts with abelian hearts}\label{ch:nakaoka} % $\mathbb{ZNR}$
%************************************************

Let $(\T^{\leq 0},\T^{\geq 0})$ be a $t$-structure in a triangulated category $\mathscr{C}$. It is well known (see \cite{bbd82}) that its heart $\clH=\T^{\leq 0}\cap\T^{\geq 0}$ is an abelian category.

A different result but in the same spirit arises for a cluster tilting subcategory $\mathscr{T}$ of a triangulated category $\mathscr{C}$. It was showed by Koenig and Zhu in \cite{Koenig2008} that in this case $\mathscr{C}/\mathscr{T}$ carries an abelian structure.

In both cases the construction of the abelian structure, i.e. of the kernels and cokernels, relies heavily on the triangulated structure of $\mathscr{C}$. In \cite{Nakaokaa}, Nakaoka proved that starting from any torsion pair $(\U,\V)$ in a triangulated category $\mathscr{C}$ it is possible to construct an abelian heart $\underline{\clH}$ in the quotient category $\underline{\mathscr{C}}=\mathscr{C}/\W$, where $\W=\U\cap\V[1]$. \todo{Check that $(\U\cap\V)$ is the exact one, since here I am referring to torsion pairs and Nakaoka uses cotorsion pairs in his article}
This result recovers both cases above giving a unified way of constructing kernels and cokernels in the heart.

Keeping this setting in mind, we will provide a set of axioms for a pair of torsion pairs $\t_1=(\T_1,\F_1)$ and $\t_2=(\T_2,\F_2)$ in a (sufficiently nice) \todo{Give a better specification of what this means}
additive category in such a way that $\clH = \T_1\cap\F_2$ becomes an abelian category. In a sense, our objective is to axiomatize $\underline{\mathscr{C}}$ and the pairs which are referred to as $(\underline{\C}^-,\underline{\V})$ and $(\underline{\U},\underline{\C}^+)$ in \cite{Nakaokaa}.

Since we don't have a triangulated structure to rely on, the axioms will impose some requirements on $\t_1$ and $\t_2$ to compensate. Moreover, we will require that idempotents split in $\mathscr{C}$.\todo{check this hypothesis}

The results in this chapter are part of a work in preparation by the author in conjunction with Manuel Saor\'in and Simone Virili.

%*****************************************
\section{Torsion pairs}
%*****************************************

Let $\mathscr{C}$ be an additive category and $\A\subseteq \mathscr{C}$ a class of objects. We introduce the following notation:
\begin{itemize}
  \item $\A\rhperp = \{X\in\mathscr{C}| \Hom_{\mathscr{C}}(\A,X)=0\}$
  \item $\lhperp{\A}=\{ X\in \mathscr{C}| \Hom_{\mathscr{C}}(X,\A)=0\}$.
\end{itemize}

Given a map $\varphi:X\to Y$, recall that a \emph{pseudocokernel} of $\varphi$ is a map $\psi:Y\to Z$ such that $\psi\varphi=0$ and any other $\psi':Y\to Z$ satisfying $\psi'\varphi=0$ factors (not necessarily uniquely) through $\psi$. There an obvious dual notion of \emph{pseudokernel}

\begin{definition}\label{5:def:torsion_pair}
  A pair $\t=(\T,\F)$ of classes of objects of $\mathscr{C}$ is a \emph{torsion pair} if:
  \begin{enumerate}
    \item $\F=\T\rhperp$ and $\T = \lhperp{\F}$,
    \item given $X\in \mathscr{C}$ there is a pseudokernel-pseudocokernel sequence
      \begin{equation*}
        T_X\nto{\varepsilon_X} X\nto{\lambda_X} F^X
      \end{equation*}
      where $T_X\in\T$ and $F^X\in\F$.
  \end{enumerate}
  Moreover, a torsion pair $\t=(\T,\F)$ is called \emph{left} (resp. \emph{right}) \emph{functorial} if $\T$ (resp. $\F$) is a coreflective
  \footnote{Recall that a full subcategory $\T$ of $\mathscr{C}$ is called coreflective if the inclusion functor $i\colon\T\to \mathscr{C}$ has a right adjoint $t$.}
  (resp. reflective) subcategory of $\mathscr{C}$. If $\t$ is both left and right functorial it is called just \emph{functorial}.
\end{definition}

\begin{rmk}
  Our definition of a torsion pair in additive categories requires the existence of a pseudokernel-pseudocokernel sequence, while the usual definition of a torsion pair in abelian categories requires a short exact sequence instead. However, as we'll show in the following lemma, the two definitions actually coincide.
\end{rmk}

\begin{lemma}
  Let $\mathscr{C}$ be an abelian category and $(\T,\F)$ be a torsion pair according to \ref{5:def:torsion_pair}. Then, for any $X\in\mathscr{C}$ there is a short exact sequence
  \begin{equation*}
    \begin{tikzcd}
      0\arrow{r}&T_X\arrow{r}&X\arrow{r}&F^X\arrow{r}&0
    \end{tikzcd}
  \end{equation*}
  with $T_X\in\T$ and $F^X\in\F$.
\end{lemma}

\begin{proof}
  Consider a pseudokernel-pseudocokernel sequence $T_X\nto{\varepsilon_X} X\nto{\lambda^X} F^X$ with $T_X\in \T$ and $F^X\in\F$, and let $K=\Ker(\lambda^X)$. Then, we have the following diagram:
  \begin{equation*}
    \begin{tikzcd}[column sep=large,row sep=large]
      & K\arrow[tail]{d}{k}\arrow[dashed,shift left]{dl}{u}
        &\\
      T_X\arrow{r}{\varepsilon_X}\arrow[dashed,shift left]{ur}{v}
      & X\arrow{r}{\lambda^X}
        & F^X
    \end{tikzcd}
  \end{equation*}
  where $u$ and $v$ are given by the (pseudo)kernel properties of $K$ and $T_X$ respectively, i.e. $k\circ u=\varepsilon_X$ and $\varepsilon_X\circ v = k$. Combining the two we get that $k\circ u\circ v = \varepsilon_X\circ v = k$, so $u\circ v=1_K$ (since $k$ is mono). Hence, $u$ is a section and $K {< \atop \oplus} T_X$.
  % NOTE: can also use $\underset{\oplus}{<}$

  This implies that $\Hom_\mathscr{C}(K,F)=0$ for all $F\in\F$, i.e. $K\in\T$. Moreover, $\lambda^X$ is a pseudocokernel of $k$. Thus, for any $X\in\mathscr{C}$ there is a short exact sequence $0\to K\nto{k} X\nto{\lambda^X} F^X$ with $K\in\T$ and $F^X\in\F$ such that $\lambda^X$ is a pseudocokernel of $k$.

  To conclude the proof, consider the cokernel of $k$ and use a dual argument to get the desired short exact sequence.
\end{proof}


It is a classical result that torsion pairs in Abelian categories are automatically functorial. Similarly, $t$-structures in triangulated categories are examples of functorial torsion pairs.

The following lemma gives basic properties of left functorial torsion pairs. The proof is omitted, since it is a straightforward application of the definitions. The dual obiously hold for right functorial torsion pairs.

\begin{lemma}\label{5:lem:1}
  Let $\t=(\T,\F)$ be a left functorial torsion pair in $\mathscr{C}$. Then
\begin{enumerate}[label=(\alph*)]
\item\label{5:lem:1a} for any $M\in\mathscr{C}$, $T'\in\T$ and $\alpha\in\Hom_\mathscr{C}(T',M)$ there is a unique $\alpha'\in\Hom_\mathscr{C}(T',t(M))$ such that $\varepsilon_M\circ\alpha'=\alpha$;

\item\label{5:lem:1b} for a morphis $g:T_1\to T_2$ in $\T$, any pseudocokernel $g^C:T_2\to C$ in $\T$ is also a pseudocokernel of $g$ in $\mathscr{C}$.
\end{enumerate}
\end{lemma}

\section{Nakaoka contexts}

\begin{definition}
  A \emph{Nakaoka context} is a pair $\t=(\t_1,\t_2)$ of torsion pairs in $\mathscr{C}$, satisfying the following axioms:
  \begin{torsionaxioms}
    \item\label{ax:ct1} $\t_1=(\T_1,\F_1)$ and $\t_2=(\T_2,\F_2)$ are respectively a left functorial and a right functorial torsion pair;
    \item\label{ax:ct2} $\T_2\subseteq \T_1$ (equiv. $\F_1\subseteq\F_2$).
  \end{torsionaxioms}
\end {definition}

\begin{notation}
  If $\t=(\t_1,\t_2)$ is a Nakaoka context, we will always use the notation $\t_i = (\T_i,\F_i)$ for $i=1,2$ and the coreflection and reflection will be indicated as:

\begin{equation*}
\begin{tikzcd}
(i_1,t_1)\colon\T_1\arrow[hook, shift left]{r}{i_1}
& \mathscr{C}\arrow[shift left]{l}{t_1}
& \mathrm{and}
& (f_2,j_2)\colon\F_2\arrow[hook, shift right]{r}[']{j_2}
& \mathscr{C}\arrow[shift right]{l}[']{f_2}.
\end{tikzcd}
\end{equation*}

The counit of the adjunction $(i_1,t_1)$ will be denoted by $\varepsilon_1\colon t_1i_1\to \id_{\T_1}$, while the unit of $(f_2,j_2)$ will be denoted by $\lambda_2\colon \id_{\F_2}\to f_2j_2$.
\end{notation}

\begin{definition}
  The \emph{heart} of a Nakaoka context $\t=(\t_1,\t_2)$ is $\clH=\clH_\t:=\T_1\cap\F_2$.
\end{definition}

In the following lemma we explicitly state two general observations about Nakaoka contexts.

\begin{lemma}\label{5:lem:2}
Let $\t=(\t_1,\t_2)$ be a Nakaoka context. Then, the followings hold true:
\begin{enumerate}[label=(\alph*)]
\item $\F_1\cap\T_2=0$;
\item $f_2(\T_1)\subseteq\clH$ and $t_1(\F_2)\subseteq\clH$.
\end{enumerate}
\end{lemma}
\begin{proof}
(a) Since $\T_2\subseteq\T_1$, we have $\F_1\cap\T_2\subseteq \F_1\cap\T_1=0$.

\smallskip\noindent
(b) Let $T_2\in\T_2$ and $F_2\in\F_2$. Then, $\Hom_\mathscr{C}(T_2,t_1(F_2))\cong \Hom_\mathscr{C}(T_2,F_2)=0$.
Hence, $t_1(F_2)\in\T_2^\perp = \F_2$. An analogous proof shows that $f_2(\T_1)\subseteq\T_1$.
\end{proof}

In the following lemma we introduce a technical condition under which we can easily construct kernels of morphisms in the heart of a given Nakaoka context.

\begin{lemma}\label{5:lem:3}
Let $\t=(\t_1,\t_2)$ be a Nakaoka context and let $f\colon H\to H'$ be a morphism in the heart $\clH=\clH_\t$. If there is a morphism $f^K\colon K\to H$, with $K\in \F_2$, such that the following sequence is exact in $\Func(\T_1, \Ab)$

\begin{equation*}
(*)\qquad 0\to (-,K)\restriction_{\T_1}\to (-,H)\restriction_{\T_1}\to (-,H')\restriction_{\T_1},
\end{equation*}
then the composition $f^K\circ \varepsilon_{1,K}\colon t_1K\to K\to H$ is a kernel for $f$ in $\clH$.
\end{lemma}
\begin{proof}
Consider the exact sequence in $(*)$ and notice that it gives, by restriction of the functors, an exact sequence of the form:
\begin{equation*}
0\to (-,K)\restriction_{\clH}\to (-,H)\restriction_{\clH}\to (-,H')\restriction_{\clH}.
\end{equation*}
The map $\varepsilon_{1,K}\colon t_1K\to K$, induces a natural isomorphism $(-,t_1K)\restriction_\clH \to (-,K)\restriction_\clH$, so we get an exact sequence
\begin{equation*}
\begin{tikzcd}
  0\arrow{r}
  & (-,t_1K)\restriction_{\clH}\arrow{r}{k\circ \varepsilon_{1,K}\circ -}
  & (-,H)\restriction_{\clH}\arrow{r}
  & (-,H')\restriction_{\clH}.
\end{tikzcd}
\end{equation*}
To conclude one notices that, since $t_1K\in\clH$ by Lemma \ref{5:lem:2}, the above exact sequence means exactly that $f^K\circ \varepsilon_{1,K}$ is a kernel of $f$.
\end{proof}


\section{Pre-abelian Nakaoka contexts}
Recall that an additive category is  \emph{pre-Abelian} if any morphism has a kernel and a cokernel. In view of Lemma~\ref{5:lem:3}, it is natural to introduce the following definition:

\begin{definition}
A Nakaoka context is said to be \emph{pre-Abelian} if it satisfies the following axioms:
\begin{torsionaxioms}\setcounter{enumi}{2}
\item\label{ax:ct3} any  $g\colon H\to H'$ in $\clH(\subseteq \T_1)$ admits a pseudocokernel $g^C\colon H'\to C$ in $\T_1$, such that
\begin{equation*}
\begin{tikzcd}
0\arrow{r} &(C,-)_{|\F_2}\arrow{r}{(g^C,-)} & (H',-)_{|\F_2}\arrow{r}{(g,-)}& (H,-)_{|\F_2}
\end{tikzcd}
\end{equation*}
is an exact sequence in $\Func(\F_2,\Ab)$.
\varitem{^\ast}\label{ax:ct3op} Dual of \ref{ax:ct3}.
\end{torsionaxioms}
\end{definition}

\begin{thm}\label{5:thm:preabelian}
For a pre-Abelian Nakaoka context $\t=(\t_1,\t_2)$, the heart $\clH=\clH_\t$ is a pre-Abelian category.
\end{thm}
\begin{proof}
This is a consequence of the axioms, Lemma \ref{5:lem:3} and its dual.
\end{proof}

In the following proposition we give a characterization of those morphisms that are monomorphisms in the heart. For this, remember that, in a pre-Abelian category, a morphism is mono if and only if its kernel is trivial.

\begin{prop}\label{prop:1.4}
  The following are equivalent for a morphism $f\colon H\to H'$ in the heart $\clH=\clH_\t$ of a pre-Abelian Nakaoka context $\t=(\t_1,\t_2)$:
  \begin{enumerate}[label=(\alph*)]
    \item $f$ is a monomorphism (in $\clH$);
    \item there is a pseudokernel $f^K\colon K\to H$ of $f$ in $\F_2$ such that $K\in \F_1$.
  \end{enumerate}
\end{prop}
\begin{proof}
  For any morphism $f\colon H\to H'$ in $\clH$, by the axiom (CT.$3^*$), we can consider a diagram as follows
  \begin{equation*}
    \begin{tikzcd}
      F_2\arrow{r}{f^K} & H\arrow{r}{f} & H'\\
      t_1{F_2}\arrow{u}{\varepsilon_{1,F_2}}\arrow{ur}[']{\tilde{f}^K}
    \end{tikzcd}
  \end{equation*}
  where $F_2\in \F_2$ is a pseudo-kernel of $f$ in $\F_2$ and, by Lemma \ref{5:lem:3}, $t_1F_2\to H$ is the kernel of $f$ in $\clH$.

  \smallskip\noindent
  (a)$\Rightarrow$(b). Since $f$ is a monomorphism in $\clH$, its kernel is trivial, that is, $t_1F_2=0$, which is equivalent to say that $F_2\in \F_1$.

  \smallskip\noindent
  (b)$\Rightarrow$(a). If  $f^K\colon K\to H$ is a pseudokernel of $f$ in $\F_2$ such that $K\in \F_1$, then the kernel $0=t_1K\to H$ of $f$ in $\clH$ is trivial, that is, $f$ is a monomorphism.
\end{proof}

\section{Integral Nakaoka contexts}

\begin{definition}
A pre-Abelian Nakaoka context $\t=(\t_1,\t_2)$ is said to be \emph{integral} provided the following axioms hold:
\begin{enumerate}
\item[(CT.4.1)] Given two morphisms $f\colon H\to H'$ and $g\colon K\to H'$ in $\clH$ such that $f$ has a pseudo-cokernel $f^C\colon H'\to C$ with $C\in \T_2$, we can construct a commutative diagram
\[
\xymatrix{
X\ar@{.>}[d]_{x_H}\ar@{.>}[r]^{x_K}&K\ar[r]^{x_K^C}\ar[d]^{g}&C'\\
H\ar[r]_f&H'\ar[r]_{f^C}&C
}
\]
where $x_K^C\colon K\to C$ is a pseudo-cokernel of $x_K$, $X\in \clH$ and $C'\in \T_2$.
\item[(CT.4.1$^*$)]  Dual to (CT.4.1).
\end{enumerate}
\end{definition}

\begin{thm}
The following are equivalent for a pre-Abelian Nakaoka context $\t=(\t_1,\t_2)$:
\begin{enumerate}[label=(\alph*)]
\item $\t$ is integral;
\item the heart $\clH=\clH_\t$ is an integral pre-Abelian category.
\end{enumerate}
\end{thm}
\begin{proof}
(a)$\Rightarrow$(b). Consider a pullback diagram in $\clH$:
\[
\xymatrix{
A\ar@{}[dr]|{PB}\ar[r]^{f'}\ar[d]_{g'}&B\ar[d]^g\\
C\ar[r]_{f}&D
}
\]
and suppose that $f$ is an epi in $\clH$. By (the dual of) Proposition \ref{prop:1.4}, we can find a pseudo-cokernel $f^C\colon D\to T_2$ of $f$, with $T_2\in \T_2$. By the axiom (CT.4.1), we obtain a commutative diagram as follows
\[
\xymatrix{
X\ar@{.>}[d]_{x_C}\ar@{.>}[r]^{x_B}&B\ar[r]^{f''}\ar[d]^{g}&T'_2\\
C\ar[r]_f&D\ar[r]_{f^C}&T_2
}
\]
where $f''\colon B\to T_2$ is a pseudo-cokernel of $x_B$, and $X\in \clH$. Since the square we started with is a pullback, there is a unique morphism $\alpha\colon X\to A$, making the following diagram commute:
\[
\xymatrix{
X\ar@/_15pt/[ddr]_{x_C}\ar@/_-15pt/[rrd]^{x_B}\ar@{.>}[dr]|\alpha\\
&A\ar@{}[dr]|{PB}\ar[r]^{f'}\ar[d]_{g'}&B\ar[d]^g\\
&C\ar[r]_{f}&D
}
\]
Now, since $x_B$ is a morphism in $\clH$ that admits a pseudo-cokernel (in $\T_1$) which belongs to $\T_2$, $x_B$ is an epimorphism in $\clH$ by Proposition \ref{prop:1.4}. Furthermore, since $x_B=f'\circ\alpha$, also $f'$ is an epi. One can prove dually that pushouts of monomorphisms are mono, so $\clH$ is integral.

\smallskip\noindent
(b)$\Rightarrow$(a). Suppose that $\clH$ is an integral category and let us show how this implies the axiom (CT.4.1), one can verify (CT.4.1$^*$) dually. Given two morphisms $f\colon H\to H'$ and $g\colon K\to H'$ in $\clH$ such that $f$ has a pseudo-cokernel $f^C\colon H'\to C$ with $C\in \T_2$, we can take the following pullback diagram in $\clH$
\[
\xymatrix{
X\ar[d]_{x_H}\ar[r]^{x_K}\ar@{}[dr]|{PB}&K\ar[d]^{g}\\
H\ar[r]_f&H'
}
\]
Now, by the integrality of $\clH$, $x_K$ is an epimorphism in $\clH$ and so, by Proposition \ref{prop:1.4}, it admits a pseudo-cockernel $K\to C'$ (in $\T_1$) such that $C'\in \T_1$.
\end{proof}




%*****************************************
%*****************************************
%*****************************************
